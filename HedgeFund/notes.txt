one hot encoding for code, sub code, sub category

filling nans - mean? median? do it by specific code?
fill 0s? - some features have almost 50% values 0, yet max can be close to 5000000
ts index fits hard to model - remove? - test data >4000, training data <3000
y_target has extremes 0-1 and 99-100 - gradient clipping for training

correlation between features - remove features under 0.4 threshold (ish)
correlation of remaining features to y_target - remove features with abs(corr) near 0
XGB model with remaining features (enough clipped and dropped for overfitting? - try lightgbm if case) 
    - play with hyperparameters to determine top list of features to keep
try linear combinations with remaining features (cfv) 





one hot encoding
23 codes
180 sub codes
4 sub categories

can one hot encoding sub categories, and target encoding for code and sub codes (if high correlation exists)

also 4 horizons (1, 3, 10, 25) - can one hot encode
(1 represents short term, 25 long term but no direct reference to the actual time)

a lot of the values with high 0s have large std dev (makes sense)
 - missing columns with large empty values and no zeros can we easily replaced with mean/median
 


 order: drop 5% y_target values
 fill missing values
 encoding
 drop cols w low correlation to y_target
 drop cols with high clustering


filling empty values:
Missing %,Recommended Action
< 5%,Simple Imputation (Median). Do not create a new column.
5% - 10%,"Gray Area. If the feature has high correlation with y_target, use an indicator. Otherwise, simple imputation."
> 10%,Method 3 (Median + Indicator Column). The missingness is likely a signal itself.







linear model on val data for dropping y_target
none - 
Validation RMSE: 32.440975
R² Score: 0.011889


top and bottom 0.5%
Validation RMSE: 12.632034
R² Score: 0.028234


top and bottom 1%
Validation RMSE: 7.897090
R² Score: 0.041549


top and bottom 2%
Validation RMSE: 3.858839
R² Score: 0.058688


top and bottom 5%
Validation RMSE: 1.124193
R² Score: 0.076526


top and bottom 10%
Validation RMSE: 0.343448
R² Score: 0.105303


top and bottom 12.5%
Validation RMSE: 0.214022
R² Score: 0.114385
    Mean weight (all): 13409914.219274
    Mean weight (dropped): 42.807257
    Mean weight (remaining): 17879893.689314


top and bottom 15%
Validation RMSE: 0.139398
R² Score: 0.117090


top and bottom 20%
Validation RMSE: 0.063781
R² Score: 0.121161
    Mean weight (all): 13409914.219274
    Mean weight (dropped): 434.741517
    Mean weight (remaining): 22349650.949837


top and bottom 25%
Validation RMSE: 0.029971
R² Score: 0.150388
    Mean weight (all): 13409914.219274
    Mean weight (dropped): 1353.121780
    Mean weight (remaining): 26818575.804355


top and bottom 30%
Validation RMSE: 0.013041
R² Score: 0.243743
    Mean weight (all): 13409914.219274
    Mean weight (dropped): 6887.453898
    Mean weight (remaining): 33514579.924977